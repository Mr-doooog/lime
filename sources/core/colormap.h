#ifndef _MSC_VER
#pragma once
#endif

#ifndef _CORE_COLORMAP_H_
#define _CORE_COLORMAP_H_

#include <iostream>
#include <opencv2/opencv.hpp>

#include "core/common.h"

namespace lime {

enum class CMap : int {
    Jet,
    CoolWarm,
    Inferno,
    Magma,
    Plasma,
    Viridis
};

using uchar3 = uint8_t[3];

static const uchar3 cmap_jet[] = {
    { 127,   0,   0 }, { 132,   0,   0 }, { 136,   0,   0 }, { 141,   0,   0 },
    { 145,   0,   0 }, { 150,   0,   0 }, { 154,   0,   0 }, { 159,   0,   0 },
    { 163,   0,   0 }, { 168,   0,   0 }, { 172,   0,   0 }, { 177,   0,   0 },
    { 182,   0,   0 }, { 186,   0,   0 }, { 191,   0,   0 }, { 195,   0,   0 },
    { 200,   0,   0 }, { 204,   0,   0 }, { 209,   0,   0 }, { 213,   0,   0 },
    { 218,   0,   0 }, { 222,   0,   0 }, { 227,   0,   0 }, { 232,   0,   0 },
    { 236,   0,   0 }, { 241,   0,   0 }, { 245,   0,   0 }, { 250,   0,   0 },
    { 254,   0,   0 }, { 255,   0,   0 }, { 255,   0,   0 }, { 255,   0,   0 },
    { 255,   0,   0 }, { 255,   4,   0 }, { 255,   8,   0 }, { 255,  12,   0 },
    { 255,  16,   0 }, { 255,  20,   0 }, { 255,  24,   0 }, { 255,  28,   0 },
    { 255,  32,   0 }, { 255,  36,   0 }, { 255,  40,   0 }, { 255,  44,   0 },
    { 255,  48,   0 }, { 255,  52,   0 }, { 255,  56,   0 }, { 255,  60,   0 },
    { 255,  64,   0 }, { 255,  68,   0 }, { 255,  72,   0 }, { 255,  76,   0 },
    { 255,  80,   0 }, { 255,  84,   0 }, { 255,  88,   0 }, { 255,  92,   0 },
    { 255,  96,   0 }, { 255, 100,   0 }, { 255, 104,   0 }, { 255, 108,   0 },
    { 255, 112,   0 }, { 255, 116,   0 }, { 255, 120,   0 }, { 255, 124,   0 },
    { 255, 128,   0 }, { 255, 132,   0 }, { 255, 136,   0 }, { 255, 140,   0 },
    { 255, 144,   0 }, { 255, 148,   0 }, { 255, 152,   0 }, { 255, 156,   0 },
    { 255, 160,   0 }, { 255, 164,   0 }, { 255, 168,   0 }, { 255, 172,   0 },
    { 255, 176,   0 }, { 255, 180,   0 }, { 255, 184,   0 }, { 255, 188,   0 },
    { 255, 192,   0 }, { 255, 196,   0 }, { 255, 200,   0 }, { 255, 204,   0 },
    { 255, 208,   0 }, { 255, 212,   0 }, { 255, 216,   0 }, { 254, 220,   0 },
    { 250, 224,   0 }, { 247, 228,   0 }, { 244, 232,   2 }, { 241, 236,   5 },
    { 237, 240,   8 }, { 234, 244,  12 }, { 231, 248,  15 }, { 228, 252,  18 },
    { 225, 255,  21 }, { 221, 255,  24 }, { 218, 255,  28 }, { 215, 255,  31 },
    { 212, 255,  34 }, { 208, 255,  37 }, { 205, 255,  41 }, { 202, 255,  44 },
    { 199, 255,  47 }, { 195, 255,  50 }, { 192, 255,  54 }, { 189, 255,  57 },
    { 186, 255,  60 }, { 183, 255,  63 }, { 179, 255,  66 }, { 176, 255,  70 },
    { 173, 255,  73 }, { 170, 255,  76 }, { 166, 255,  79 }, { 163, 255,  83 },
    { 160, 255,  86 }, { 157, 255,  89 }, { 154, 255,  92 }, { 150, 255,  95 },
    { 147, 255,  99 }, { 144, 255, 102 }, { 141, 255, 105 }, { 137, 255, 108 },
    { 134, 255, 112 }, { 131, 255, 115 }, { 128, 255, 118 }, { 125, 255, 121 },
    { 121, 255, 124 }, { 118, 255, 128 }, { 115, 255, 131 }, { 112, 255, 134 },
    { 108, 255, 137 }, { 105, 255, 141 }, { 102, 255, 144 }, {  99, 255, 147 },
    {  95, 255, 150 }, {  92, 255, 154 }, {  89, 255, 157 }, {  86, 255, 160 },
    {  83, 255, 163 }, {  79, 255, 166 }, {  76, 255, 170 }, {  73, 255, 173 },
    {  70, 255, 176 }, {  66, 255, 179 }, {  63, 255, 183 }, {  60, 255, 186 },
    {  57, 255, 189 }, {  54, 255, 192 }, {  50, 255, 195 }, {  47, 255, 199 },
    {  44, 255, 202 }, {  41, 255, 205 }, {  37, 255, 208 }, {  34, 255, 212 },
    {  31, 255, 215 }, {  28, 255, 218 }, {  24, 255, 221 }, {  21, 255, 224 },
    {  18, 255, 228 }, {  15, 255, 231 }, {  12, 255, 234 }, {   8, 255, 237 },
    {   5, 252, 241 }, {   2, 248, 244 }, {   0, 244, 247 }, {   0, 240, 250 },
    {   0, 237, 254 }, {   0, 233, 255 }, {   0, 229, 255 }, {   0, 226, 255 },
    {   0, 222, 255 }, {   0, 218, 255 }, {   0, 215, 255 }, {   0, 211, 255 },
    {   0, 207, 255 }, {   0, 203, 255 }, {   0, 200, 255 }, {   0, 196, 255 },
    {   0, 192, 255 }, {   0, 189, 255 }, {   0, 185, 255 }, {   0, 181, 255 },
    {   0, 177, 255 }, {   0, 174, 255 }, {   0, 170, 255 }, {   0, 166, 255 },
    {   0, 163, 255 }, {   0, 159, 255 }, {   0, 155, 255 }, {   0, 152, 255 },
    {   0, 148, 255 }, {   0, 144, 255 }, {   0, 140, 255 }, {   0, 137, 255 },
    {   0, 133, 255 }, {   0, 129, 255 }, {   0, 126, 255 }, {   0, 122, 255 },
    {   0, 118, 255 }, {   0, 115, 255 }, {   0, 111, 255 }, {   0, 107, 255 },
    {   0, 103, 255 }, {   0, 100, 255 }, {   0,  96, 255 }, {   0,  92, 255 },
    {   0,  89, 255 }, {   0,  85, 255 }, {   0,  81, 255 }, {   0,  77, 255 },
    {   0,  74, 255 }, {   0,  70, 255 }, {   0,  66, 255 }, {   0,  63, 255 },
    {   0,  59, 255 }, {   0,  55, 255 }, {   0,  52, 255 }, {   0,  48, 255 },
    {   0,  44, 255 }, {   0,  40, 255 }, {   0,  37, 255 }, {   0,  33, 255 },
    {   0,  29, 255 }, {   0,  26, 255 }, {   0,  22, 255 }, {   0,  18, 254 },
    {   0,  15, 250 }, {   0,  11, 245 }, {   0,   7, 241 }, {   0,   3, 236 },
    {   0,   0, 232 }, {   0,   0, 227 }, {   0,   0, 222 }, {   0,   0, 218 },
    {   0,   0, 213 }, {   0,   0, 209 }, {   0,   0, 204 }, {   0,   0, 200 },
    {   0,   0, 195 }, {   0,   0, 191 }, {   0,   0, 186 }, {   0,   0, 182 },
    {   0,   0, 177 }, {   0,   0, 172 }, {   0,   0, 168 }, {   0,   0, 163 },
    {   0,   0, 159 }, {   0,   0, 154 }, {   0,   0, 150 }, {   0,   0, 145 },
    {   0,   0, 141 }, {   0,   0, 136 }, {   0,   0, 132 }, {   0,   0, 127 },
};

static const uchar3 cmap_coolwarm[] = {
    { 192,  76,  58 }, { 193,  77,  59 }, { 195,  79,  60 }, { 196,  81,  62 },
    { 198,  83,  63 }, { 199,  84,  64 }, { 201,  86,  65 }, { 202,  88,  66 },
    { 204,  90,  67 }, { 205,  91,  69 }, { 207,  93,  70 }, { 208,  95,  71 },
    { 209,  96,  72 }, { 211,  98,  73 }, { 212, 100,  75 }, { 214, 102,  76 },
    { 215, 103,  77 }, { 216, 105,  78 }, { 218, 107,  80 }, { 219, 108,  81 },
    { 220, 110,  82 }, { 221, 112,  83 }, { 222, 113,  85 }, { 224, 115,  86 },
    { 225, 117,  87 }, { 226, 118,  88 }, { 227, 120,  90 }, { 228, 121,  91 },
    { 229, 123,  92 }, { 230, 125,  93 }, { 231, 126,  95 }, { 232, 128,  96 },
    { 234, 130,  97 }, { 234, 131,  99 }, { 235, 133, 100 }, { 236, 134, 101 },
    { 237, 136, 103 }, { 238, 137, 104 }, { 239, 139, 105 }, { 240, 141, 107 },
    { 241, 142, 108 }, { 241, 144, 109 }, { 242, 145, 111 }, { 243, 147, 112 },
    { 244, 148, 113 }, { 244, 149, 115 }, { 245, 151, 116 }, { 246, 152, 117 },
    { 246, 154, 119 }, { 247, 155, 120 }, { 248, 157, 122 }, { 248, 158, 123 },
    { 249, 160, 124 }, { 249, 161, 126 }, { 250, 162, 127 }, { 250, 164, 128 },
    { 251, 165, 130 }, { 251, 166, 131 }, { 251, 168, 133 }, { 252, 169, 134 },
    { 252, 170, 135 }, { 252, 172, 137 }, { 253, 173, 138 }, { 253, 174, 139 },
    { 253, 175, 141 }, { 253, 177, 142 }, { 254, 178, 144 }, { 254, 179, 145 },
    { 254, 180, 146 }, { 254, 181, 148 }, { 254, 183, 149 }, { 254, 184, 151 },
    { 254, 185, 152 }, { 254, 186, 153 }, { 254, 187, 155 }, { 254, 188, 156 },
    { 254, 189, 157 }, { 254, 190, 159 }, { 254, 191, 160 }, { 254, 192, 162 },
    { 254, 193, 163 }, { 254, 194, 164 }, { 253, 195, 166 }, { 253, 196, 167 },
    { 253, 197, 168 }, { 253, 198, 170 }, { 252, 199, 171 }, { 252, 200, 172 },
    { 252, 201, 174 }, { 251, 202, 175 }, { 251, 203, 176 }, { 251, 203, 178 },
    { 250, 204, 179 }, { 250, 205, 180 }, { 249, 206, 182 }, { 249, 207, 183 },
    { 248, 207, 184 }, { 248, 208, 185 }, { 247, 209, 187 }, { 246, 209, 188 },
    { 246, 210, 189 }, { 245, 211, 190 }, { 245, 211, 192 }, { 244, 212, 193 },
    { 243, 212, 194 }, { 242, 213, 195 }, { 242, 213, 197 }, { 241, 214, 198 },
    { 240, 214, 199 }, { 239, 215, 200 }, { 238, 215, 201 }, { 238, 216, 202 },
    { 237, 216, 204 }, { 236, 217, 205 }, { 235, 217, 206 }, { 234, 217, 207 },
    { 233, 218, 208 }, { 232, 218, 209 }, { 231, 218, 210 }, { 230, 219, 211 },
    { 229, 219, 213 }, { 228, 219, 214 }, { 226, 219, 215 }, { 225, 219, 216 },
    { 224, 220, 217 }, { 223, 220, 218 }, { 222, 220, 219 }, { 221, 220, 220 },
    { 219, 220, 221 }, { 218, 219, 222 }, { 217, 219, 223 }, { 215, 218, 224 },
    { 214, 218, 225 }, { 212, 217, 226 }, { 211, 217, 227 }, { 209, 216, 228 },
    { 208, 216, 229 }, { 207, 215, 230 }, { 205, 214, 231 }, { 204, 214, 231 },
    { 202, 213, 232 }, { 201, 212, 233 }, { 199, 211, 234 }, { 198, 211, 235 },
    { 196, 210, 236 }, { 195, 209, 236 }, { 193, 208, 237 }, { 192, 207, 237 },
    { 190, 207, 238 }, { 188, 206, 239 }, { 187, 205, 239 }, { 185, 204, 240 },
    { 184, 203, 241 }, { 182, 202, 241 }, { 181, 201, 242 }, { 179, 200, 242 },
    { 178, 199, 242 }, { 176, 198, 243 }, { 175, 197, 243 }, { 173, 196, 244 },
    { 171, 195, 244 }, { 170, 194, 244 }, { 168, 193, 245 }, { 167, 192, 245 },
    { 165, 191, 245 }, { 164, 189, 246 }, { 162, 188, 246 }, { 160, 187, 246 },
    { 159, 186, 246 }, { 157, 185, 246 }, { 156, 183, 246 }, { 154, 182, 246 },
    { 152, 181, 247 }, { 151, 179, 247 }, { 149, 178, 247 }, { 148, 177, 247 },
    { 146, 176, 247 }, { 145, 174, 247 }, { 143, 173, 247 }, { 141, 171, 246 },
    { 140, 170, 246 }, { 138, 169, 246 }, { 137, 167, 246 }, { 135, 166, 246 },
    { 134, 164, 246 }, { 132, 163, 246 }, { 130, 161, 245 }, { 129, 160, 245 },
    { 127, 158, 245 }, { 126, 157, 244 }, { 124, 155, 244 }, { 123, 154, 244 },
    { 121, 152, 243 }, { 120, 150, 243 }, { 118, 149, 243 }, { 117, 147, 242 },
    { 115, 145, 242 }, { 114, 144, 241 }, { 112, 142, 241 }, { 111, 141, 240 },
    { 109, 139, 240 }, { 108, 137, 239 }, { 106, 135, 238 }, { 105, 134, 238 },
    { 103, 132, 237 }, { 102, 130, 236 }, { 100, 128, 236 }, {  99, 127, 235 },
    {  97, 125, 234 }, {  96, 123, 234 }, {  94, 121, 233 }, {  93, 119, 232 },
    {  92, 117, 231 }, {  90, 116, 230 }, {  89, 114, 230 }, {  87, 112, 229 },
    {  86, 110, 228 }, {  84, 108, 227 }, {  83, 106, 226 }, {  82, 104, 225 },
    {  80, 102, 224 }, {  79, 100, 223 }, {  78,  98, 222 }, {  76,  96, 221 },
    {  75,  94, 220 }, {  74,  92, 219 }, {  72,  90, 218 }, {  71,  88, 217 },
    {  70,  86, 216 }, {  68,  84, 215 }, {  67,  82, 214 }, {  66,  79, 212 },
    {  64,  77, 211 }, {  63,  75, 210 }, {  62,  73, 209 }, {  61,  70, 207 },
    {  60,  68, 206 }, {  58,  66, 205 }, {  57,  63, 204 }, {  56,  61, 202 },
    {  55,  59, 201 }, {  53,  56, 200 }, {  52,  53, 198 }, {  51,  50, 197 },
    {  50,  48, 196 }, {  49,  45, 194 }, {  48,  42, 193 }, {  46,  40, 191 },
    {  45,  35, 190 }, {  44,  31, 188 }, {  43,  26, 187 }, {  42,  22, 185 },
    {  41,  17, 184 }, {  40,  13, 182 }, {  39,   8, 181 }, {  38,   3, 179 },
};

static const uchar3 cmap_inferno[] = {
    {   3,   0,   0 }, {   4,   0,   0 }, {   6,   0,   0 }, {   7,   0,   1 },
    {   9,   1,   1 }, {  11,   1,   1 }, {  14,   1,   2 }, {  16,   2,   2 },
    {  18,   2,   3 }, {  20,   3,   4 }, {  22,   3,   4 }, {  24,   4,   5 },
    {  27,   4,   6 }, {  29,   5,   7 }, {  31,   6,   8 }, {  33,   6,   9 },
    {  35,   7,  10 }, {  38,   7,  11 }, {  40,   8,  13 }, {  42,   8,  14 },
    {  45,   9,  15 }, {  47,   9,  16 }, {  50,  10,  18 }, {  52,  10,  19 },
    {  54,  11,  20 }, {  57,  11,  22 }, {  59,  11,  23 }, {  62,  11,  25 },
    {  64,  11,  26 }, {  67,  12,  28 }, {  69,  12,  29 }, {  71,  12,  31 },
    {  74,  12,  32 }, {  76,  11,  34 }, {  78,  11,  36 }, {  80,  11,  38 },
    {  82,  11,  39 }, {  84,  11,  41 }, {  86,  10,  43 }, {  88,  10,  45 },
    {  90,  10,  46 }, {  92,  10,  48 }, {  93,   9,  50 }, {  95,   9,  52 },
    {  96,   9,  53 }, {  97,   9,  55 }, {  98,   9,  57 }, { 100,   9,  59 },
    { 101,   9,  60 }, { 102,   9,  62 }, { 102,   9,  64 }, { 103,   9,  65 },
    { 104,  10,  67 }, { 105,  10,  69 }, { 105,  10,  70 }, { 106,  11,  72 },
    { 106,  11,  74 }, { 107,  12,  75 }, { 107,  12,  77 }, { 108,  13,  79 },
    { 108,  13,  80 }, { 108,  14,  82 }, { 109,  14,  83 }, { 109,  15,  85 },
    { 109,  15,  87 }, { 109,  16,  88 }, { 109,  17,  90 }, { 110,  17,  91 },
    { 110,  18,  93 }, { 110,  18,  95 }, { 110,  19,  96 }, { 110,  20,  98 },
    { 110,  20,  99 }, { 110,  21, 101 }, { 110,  21, 102 }, { 110,  22, 104 },
    { 110,  23, 106 }, { 110,  23, 107 }, { 110,  24, 109 }, { 110,  24, 110 },
    { 110,  25, 112 }, { 109,  25, 114 }, { 109,  26, 115 }, { 109,  27, 117 },
    { 109,  27, 118 }, { 109,  28, 120 }, { 109,  28, 122 }, { 108,  29, 123 },
    { 108,  29, 125 }, { 108,  30, 126 }, { 107,  31, 128 }, { 107,  31, 129 },
    { 107,  32, 131 }, { 106,  32, 133 }, { 106,  33, 134 }, { 106,  33, 136 },
    { 105,  34, 137 }, { 105,  34, 139 }, { 105,  35, 141 }, { 104,  36, 142 },
    { 104,  36, 144 }, { 103,  37, 145 }, { 103,  37, 147 }, { 102,  38, 149 },
    { 102,  38, 150 }, { 101,  39, 152 }, { 100,  40, 153 }, { 100,  40, 155 },
    {  99,  41, 156 }, {  99,  41, 158 }, {  98,  42, 160 }, {  97,  43, 161 },
    {  97,  43, 163 }, {  96,  44, 164 }, {  95,  44, 166 }, {  95,  45, 167 },
    {  94,  46, 169 }, {  93,  46, 171 }, {  92,  47, 172 }, {  91,  48, 174 },
    {  91,  49, 175 }, {  90,  49, 177 }, {  89,  50, 178 }, {  88,  51, 180 },
    {  87,  51, 181 }, {  86,  52, 183 }, {  86,  53, 184 }, {  85,  54, 186 },
    {  84,  55, 187 }, {  83,  55, 189 }, {  82,  56, 190 }, {  81,  57, 191 },
    {  80,  58, 193 }, {  79,  59, 194 }, {  78,  60, 196 }, {  77,  61, 197 },
    {  76,  62, 199 }, {  75,  62, 200 }, {  74,  63, 201 }, {  73,  64, 203 },
    {  72,  65, 204 }, {  71,  66, 205 }, {  70,  68, 207 }, {  68,  69, 208 },
    {  67,  70, 209 }, {  66,  71, 210 }, {  65,  72, 212 }, {  64,  73, 213 },
    {  63,  74, 214 }, {  62,  75, 215 }, {  61,  77, 217 }, {  59,  78, 218 },
    {  58,  79, 219 }, {  57,  80, 220 }, {  56,  82, 221 }, {  55,  83, 222 },
    {  54,  84, 223 }, {  52,  86, 224 }, {  51,  87, 226 }, {  50,  88, 227 },
    {  49,  90, 228 }, {  48,  91, 229 }, {  46,  92, 230 }, {  45,  94, 230 },
    {  44,  95, 231 }, {  43,  97, 232 }, {  42,  98, 233 }, {  40, 100, 234 },
    {  39, 101, 235 }, {  38, 103, 236 }, {  37, 104, 237 }, {  35, 106, 237 },
    {  34, 108, 238 }, {  33, 109, 239 }, {  31, 111, 240 }, {  30, 112, 240 },
    {  29, 114, 241 }, {  28, 116, 242 }, {  26, 117, 242 }, {  25, 119, 243 },
    {  24, 121, 243 }, {  22, 122, 244 }, {  21, 124, 245 }, {  20, 126, 245 },
    {  18, 128, 246 }, {  17, 129, 246 }, {  16, 131, 247 }, {  14, 133, 247 },
    {  13, 135, 248 }, {  12, 136, 248 }, {  11, 138, 248 }, {   9, 140, 249 },
    {   8, 142, 249 }, {   8, 144, 249 }, {   7, 145, 250 }, {   6, 147, 250 },
    {   6, 149, 250 }, {   6, 151, 250 }, {   6, 153, 251 }, {   6, 155, 251 },
    {   6, 157, 251 }, {   7, 158, 251 }, {   7, 160, 251 }, {   8, 162, 251 },
    {  10, 164, 251 }, {  11, 166, 251 }, {  13, 168, 251 }, {  14, 170, 251 },
    {  16, 172, 251 }, {  18, 174, 251 }, {  20, 176, 251 }, {  22, 177, 251 },
    {  24, 179, 251 }, {  26, 181, 251 }, {  28, 183, 251 }, {  30, 185, 251 },
    {  33, 187, 250 }, {  35, 189, 250 }, {  37, 191, 250 }, {  40, 193, 250 },
    {  42, 195, 249 }, {  44, 197, 249 }, {  47, 199, 249 }, {  49, 201, 248 },
    {  52, 203, 248 }, {  55, 205, 248 }, {  58, 207, 247 }, {  60, 209, 247 },
    {  63, 211, 246 }, {  66, 213, 246 }, {  69, 215, 245 }, {  72, 217, 245 },
    {  75, 219, 244 }, {  79, 220, 244 }, {  82, 222, 243 }, {  86, 224, 243 },
    {  89, 226, 243 }, {  93, 228, 242 }, {  96, 230, 242 }, { 100, 232, 241 },
    { 104, 233, 241 }, { 108, 235, 241 }, { 112, 237, 241 }, { 116, 238, 241 },
    { 121, 240, 241 }, { 125, 242, 241 }, { 129, 243, 242 }, { 133, 244, 242 },
    { 137, 246, 243 }, { 141, 247, 244 }, { 145, 248, 245 }, { 149, 250, 246 },
    { 153, 251, 247 }, { 157, 252, 249 }, { 160, 253, 250 }, { 164, 254, 252 },
};

static const uchar3 cmap_magma[] = {
    {   3,   0,   0 }, {   4,   0,   0 }, {   6,   0,   0 }, {   7,   0,   1 },
    {   9,   1,   1 }, {  11,   1,   1 }, {  13,   2,   2 }, {  15,   2,   2 },
    {  17,   3,   3 }, {  19,   3,   4 }, {  21,   4,   4 }, {  23,   4,   5 },
    {  25,   5,   6 }, {  27,   5,   7 }, {  29,   6,   8 }, {  31,   7,   9 },
    {  34,   7,  10 }, {  36,   8,  11 }, {  38,   9,  12 }, {  40,  10,  13 },
    {  42,  10,  14 }, {  44,  11,  15 }, {  47,  12,  16 }, {  49,  12,  17 },
    {  51,  13,  18 }, {  53,  13,  20 }, {  56,  14,  21 }, {  58,  14,  22 },
    {  60,  15,  23 }, {  63,  15,  24 }, {  65,  16,  26 }, {  68,  16,  27 },
    {  70,  16,  28 }, {  73,  16,  30 }, {  75,  17,  31 }, {  77,  17,  32 },
    {  80,  17,  34 }, {  82,  17,  35 }, {  85,  17,  37 }, {  87,  17,  38 },
    {  89,  17,  40 }, {  92,  17,  42 }, {  94,  17,  43 }, {  96,  16,  45 },
    {  98,  16,  47 }, { 101,  16,  48 }, { 103,  16,  50 }, { 104,  16,  52 },
    { 106,  15,  53 }, { 108,  15,  55 }, { 110,  15,  57 }, { 111,  15,  59 },
    { 113,  15,  60 }, { 114,  15,  62 }, { 115,  15,  64 }, { 116,  15,  66 },
    { 117,  15,  67 }, { 118,  15,  69 }, { 119,  15,  71 }, { 120,  16,  72 },
    { 121,  16,  74 }, { 121,  16,  75 }, { 122,  17,  77 }, { 123,  17,  79 },
    { 123,  18,  80 }, { 124,  18,  82 }, { 124,  19,  83 }, { 125,  19,  85 },
    { 125,  20,  87 }, { 126,  21,  88 }, { 126,  21,  90 }, { 126,  22,  91 },
    { 126,  23,  93 }, { 127,  23,  94 }, { 127,  24,  96 }, { 127,  24,  97 },
    { 127,  25,  99 }, { 128,  26, 101 }, { 128,  26, 102 }, { 128,  27, 104 },
    { 128,  28, 105 }, { 128,  28, 107 }, { 128,  29, 108 }, { 129,  30, 110 },
    { 129,  30, 111 }, { 129,  31, 113 }, { 129,  31, 115 }, { 129,  32, 116 },
    { 129,  33, 118 }, { 129,  33, 119 }, { 129,  34, 121 }, { 129,  34, 122 },
    { 129,  35, 124 }, { 129,  36, 126 }, { 129,  36, 127 }, { 129,  37, 129 },
    { 129,  37, 130 }, { 129,  38, 132 }, { 129,  38, 133 }, { 129,  39, 135 },
    { 129,  40, 137 }, { 129,  40, 138 }, { 128,  41, 140 }, { 128,  41, 141 },
    { 128,  42, 143 }, { 128,  42, 145 }, { 128,  43, 146 }, { 128,  43, 148 },
    { 128,  44, 149 }, { 127,  44, 151 }, { 127,  45, 153 }, { 127,  45, 154 },
    { 127,  46, 156 }, { 126,  46, 158 }, { 126,  47, 159 }, { 126,  47, 161 },
    { 126,  48, 163 }, { 125,  48, 164 }, { 125,  49, 166 }, { 125,  49, 167 },
    { 124,  50, 169 }, { 124,  51, 171 }, { 123,  51, 172 }, { 123,  52, 174 },
    { 123,  52, 176 }, { 122,  53, 177 }, { 122,  53, 179 }, { 121,  54, 181 },
    { 121,  54, 182 }, { 120,  55, 184 }, { 120,  55, 185 }, { 119,  56, 187 },
    { 119,  57, 189 }, { 118,  57, 190 }, { 117,  58, 192 }, { 117,  58, 194 },
    { 116,  59, 195 }, { 116,  60, 197 }, { 115,  60, 198 }, { 114,  61, 200 },
    { 114,  62, 202 }, { 113,  62, 203 }, { 112,  63, 205 }, { 112,  64, 206 },
    { 111,  65, 208 }, { 110,  66, 209 }, { 109,  66, 211 }, { 109,  67, 212 },
    { 108,  68, 214 }, { 107,  69, 215 }, { 106,  70, 217 }, { 105,  71, 218 },
    { 105,  72, 220 }, { 104,  73, 221 }, { 103,  74, 222 }, { 102,  75, 224 },
    { 102,  76, 225 }, { 101,  77, 226 }, { 100,  78, 228 }, {  99,  80, 229 },
    {  98,  81, 230 }, {  98,  82, 231 }, {  97,  84, 232 }, {  96,  85, 234 },
    {  96,  86, 235 }, {  95,  88, 236 }, {  95,  89, 237 }, {  94,  91, 238 },
    {  93,  93, 238 }, {  93,  94, 239 }, {  93,  96, 240 }, {  92,  97, 241 },
    {  92,  99, 242 }, {  92, 101, 243 }, {  91, 103, 243 }, {  91, 104, 244 },
    {  91, 106, 245 }, {  91, 108, 245 }, {  91, 110, 246 }, {  91, 112, 246 },
    {  91, 113, 247 }, {  92, 115, 247 }, {  92, 117, 248 }, {  92, 119, 248 },
    {  92, 121, 249 }, {  93, 123, 249 }, {  93, 125, 249 }, {  94, 127, 250 },
    {  94, 128, 250 }, {  95, 130, 250 }, {  96, 132, 251 }, {  96, 134, 251 },
    {  97, 136, 251 }, {  98, 138, 251 }, {  99, 140, 252 }, {  99, 142, 252 },
    { 100, 144, 252 }, { 101, 146, 252 }, { 102, 147, 252 }, { 103, 149, 253 },
    { 104, 151, 253 }, { 105, 153, 253 }, { 106, 155, 253 }, { 107, 157, 253 },
    { 108, 159, 253 }, { 110, 161, 253 }, { 111, 162, 253 }, { 112, 164, 253 },
    { 113, 166, 254 }, { 115, 168, 254 }, { 116, 170, 254 }, { 117, 172, 254 },
    { 118, 174, 254 }, { 120, 175, 254 }, { 121, 177, 254 }, { 123, 179, 254 },
    { 124, 181, 254 }, { 125, 183, 254 }, { 127, 185, 254 }, { 128, 187, 254 },
    { 130, 188, 254 }, { 131, 190, 254 }, { 133, 192, 254 }, { 134, 194, 254 },
    { 136, 196, 254 }, { 137, 198, 254 }, { 139, 199, 254 }, { 141, 201, 254 },
    { 142, 203, 254 }, { 144, 205, 253 }, { 146, 207, 253 }, { 147, 209, 253 },
    { 149, 210, 253 }, { 151, 212, 253 }, { 152, 214, 253 }, { 154, 216, 253 },
    { 156, 218, 253 }, { 157, 220, 253 }, { 159, 221, 253 }, { 161, 223, 253 },
    { 163, 225, 253 }, { 165, 227, 252 }, { 166, 229, 252 }, { 168, 230, 252 },
    { 170, 232, 252 }, { 172, 234, 252 }, { 174, 236, 252 }, { 176, 238, 252 },
    { 177, 240, 252 }, { 179, 241, 252 }, { 181, 243, 252 }, { 183, 245, 252 },
    { 185, 247, 251 }, { 187, 249, 251 }, { 189, 250, 251 }, { 191, 252, 251 },
};

static const uchar3 cmap_plasma[] = {
    { 134,   7,  12 }, { 135,   7,  16 }, { 137,   6,  19 }, { 138,   6,  21 },
    { 139,   6,  24 }, { 140,   6,  27 }, { 141,   6,  29 }, { 142,   5,  31 },
    { 143,   5,  33 }, { 144,   5,  35 }, { 145,   5,  37 }, { 146,   5,  39 },
    { 147,   5,  41 }, { 148,   5,  43 }, { 148,   4,  45 }, { 149,   4,  47 },
    { 150,   4,  49 }, { 151,   4,  51 }, { 152,   4,  52 }, { 152,   4,  54 },
    { 153,   4,  56 }, { 154,   4,  58 }, { 154,   3,  59 }, { 155,   3,  61 },
    { 156,   3,  63 }, { 156,   3,  64 }, { 157,   3,  66 }, { 158,   3,  68 },
    { 158,   3,  69 }, { 159,   2,  71 }, { 159,   2,  73 }, { 160,   2,  74 },
    { 161,   2,  76 }, { 161,   2,  78 }, { 162,   2,  79 }, { 162,   1,  81 },
    { 163,   1,  82 }, { 163,   1,  84 }, { 163,   1,  86 }, { 164,   1,  87 },
    { 164,   1,  89 }, { 165,   0,  90 }, { 165,   0,  92 }, { 165,   0,  94 },
    { 166,   0,  95 }, { 166,   0,  97 }, { 166,   0,  98 }, { 167,   0, 100 },
    { 167,   0, 101 }, { 167,   0, 103 }, { 167,   0, 104 }, { 167,   0, 106 },
    { 168,   0, 108 }, { 168,   0, 109 }, { 168,   0, 111 }, { 168,   0, 112 },
    { 168,   0, 114 }, { 168,   0, 115 }, { 168,   0, 117 }, { 168,   1, 118 },
    { 168,   1, 120 }, { 168,   1, 121 }, { 168,   2, 123 }, { 167,   2, 124 },
    { 167,   3, 126 }, { 167,   3, 127 }, { 167,   4, 129 }, { 167,   4, 130 },
    { 166,   5, 132 }, { 166,   6, 133 }, { 166,   7, 134 }, { 165,   7, 136 },
    { 165,   8, 137 }, { 164,   9, 139 }, { 164,  10, 140 }, { 164,  12, 142 },
    { 163,  13, 143 }, { 163,  14, 144 }, { 162,  15, 146 }, { 161,  16, 147 },
    { 161,  17, 149 }, { 160,  18, 150 }, { 160,  19, 151 }, { 159,  20, 153 },
    { 158,  21, 154 }, { 158,  23, 155 }, { 157,  24, 157 }, { 156,  25, 158 },
    { 155,  26, 159 }, { 155,  27, 160 }, { 154,  28, 162 }, { 153,  29, 163 },
    { 152,  30, 164 }, { 151,  31, 165 }, { 151,  33, 167 }, { 150,  34, 168 },
    { 149,  35, 169 }, { 148,  36, 170 }, { 147,  37, 172 }, { 146,  38, 173 },
    { 145,  39, 174 }, { 144,  40, 175 }, { 143,  42, 176 }, { 143,  43, 177 },
    { 142,  44, 178 }, { 141,  45, 180 }, { 140,  46, 181 }, { 139,  47, 182 },
    { 138,  48, 183 }, { 137,  50, 184 }, { 136,  51, 185 }, { 135,  52, 186 },
    { 134,  53, 187 }, { 133,  54, 188 }, { 132,  55, 189 }, { 131,  56, 190 },
    { 130,  57, 191 }, { 129,  59, 192 }, { 128,  60, 193 }, { 128,  61, 194 },
    { 127,  62, 195 }, { 126,  63, 196 }, { 125,  64, 197 }, { 124,  65, 198 },
    { 123,  66, 199 }, { 122,  68, 200 }, { 121,  69, 201 }, { 120,  70, 202 },
    { 119,  71, 203 }, { 118,  72, 204 }, { 117,  73, 205 }, { 117,  74, 206 },
    { 116,  75, 207 }, { 115,  77, 208 }, { 114,  78, 209 }, { 113,  79, 209 },
    { 112,  80, 210 }, { 111,  81, 211 }, { 110,  82, 212 }, { 109,  83, 213 },
    { 109,  85, 214 }, { 108,  86, 215 }, { 107,  87, 215 }, { 106,  88, 216 },
    { 105,  89, 217 }, { 104,  90, 218 }, { 103,  91, 219 }, { 102,  93, 220 },
    { 102,  94, 220 }, { 101,  95, 221 }, { 100,  96, 222 }, {  99,  97, 223 },
    {  98,  98, 223 }, {  97, 100, 224 }, {  96, 101, 225 }, {  96, 102, 226 },
    {  95, 103, 227 }, {  94, 104, 227 }, {  93, 106, 228 }, {  92, 107, 229 },
    {  91, 108, 229 }, {  90, 109, 230 }, {  90, 110, 231 }, {  89, 112, 232 },
    {  88, 113, 232 }, {  87, 114, 233 }, {  86, 115, 234 }, {  85, 116, 234 },
    {  84, 118, 235 }, {  84, 119, 236 }, {  83, 120, 236 }, {  82, 121, 237 },
    {  81, 123, 237 }, {  80, 124, 238 }, {  79, 125, 239 }, {  78, 126, 239 },
    {  77, 128, 240 }, {  77, 129, 240 }, {  76, 130, 241 }, {  75, 132, 242 },
    {  74, 133, 242 }, {  73, 134, 243 }, {  72, 135, 243 }, {  71, 137, 244 },
    {  71, 138, 244 }, {  70, 139, 245 }, {  69, 141, 245 }, {  68, 142, 246 },
    {  67, 143, 246 }, {  66, 145, 246 }, {  65, 146, 247 }, {  65, 147, 247 },
    {  64, 149, 248 }, {  63, 150, 248 }, {  62, 152, 248 }, {  61, 153, 249 },
    {  60, 154, 249 }, {  59, 156, 250 }, {  58, 157, 250 }, {  58, 159, 250 },
    {  57, 160, 250 }, {  56, 162, 251 }, {  55, 163, 251 }, {  54, 164, 251 },
    {  53, 166, 252 }, {  53, 167, 252 }, {  52, 169, 252 }, {  51, 170, 252 },
    {  50, 172, 252 }, {  49, 173, 252 }, {  49, 175, 253 }, {  48, 176, 253 },
    {  47, 178, 253 }, {  46, 179, 253 }, {  45, 181, 253 }, {  45, 182, 253 },
    {  44, 184, 253 }, {  43, 185, 253 }, {  43, 187, 253 }, {  42, 188, 253 },
    {  41, 190, 253 }, {  41, 192, 253 }, {  40, 193, 253 }, {  40, 195, 253 },
    {  39, 196, 253 }, {  38, 198, 253 }, {  38, 199, 252 }, {  38, 201, 252 },
    {  37, 203, 252 }, {  37, 204, 252 }, {  37, 206, 252 }, {  36, 208, 251 },
    {  36, 209, 251 }, {  36, 211, 251 }, {  36, 213, 250 }, {  36, 214, 250 },
    {  36, 216, 250 }, {  36, 217, 249 }, {  36, 219, 249 }, {  36, 221, 248 },
    {  36, 223, 248 }, {  36, 224, 247 }, {  37, 226, 247 }, {  37, 228, 246 },
    {  37, 229, 246 }, {  38, 231, 245 }, {  38, 233, 245 }, {  38, 234, 244 },
    {  38, 236, 243 }, {  38, 238, 243 }, {  38, 240, 242 }, {  38, 241, 242 },
    {  38, 243, 241 }, {  37, 245, 240 }, {  35, 246, 240 }, {  33, 248, 239 },
};

static const uchar3 cmap_viridis[] = {
    {  84,   1,  68 }, {  85,   2,  68 }, {  87,   3,  68 }, {  88,   5,  69 },
    {  90,   6,  69 }, {  91,   8,  69 }, {  92,   9,  70 }, {  94,  11,  70 },
    {  95,  12,  70 }, {  97,  14,  70 }, {  98,  15,  71 }, {  99,  17,  71 },
    { 101,  18,  71 }, { 102,  20,  71 }, { 103,  21,  71 }, { 105,  22,  71 },
    { 106,  24,  71 }, { 107,  25,  72 }, { 108,  26,  72 }, { 110,  28,  72 },
    { 111,  29,  72 }, { 112,  30,  72 }, { 113,  32,  72 }, { 114,  33,  72 },
    { 115,  34,  72 }, { 116,  35,  72 }, { 117,  37,  71 }, { 118,  38,  71 },
    { 119,  39,  71 }, { 120,  40,  71 }, { 121,  42,  71 }, { 122,  43,  71 },
    { 123,  44,  71 }, { 124,  45,  70 }, { 124,  47,  70 }, { 125,  48,  70 },
    { 126,  49,  70 }, { 127,  50,  69 }, { 127,  52,  69 }, { 128,  53,  69 },
    { 129,  54,  69 }, { 129,  55,  68 }, { 130,  57,  68 }, { 131,  58,  67 },
    { 131,  59,  67 }, { 132,  60,  67 }, { 132,  61,  66 }, { 133,  62,  66 },
    { 133,  64,  66 }, { 134,  65,  65 }, { 134,  66,  65 }, { 135,  67,  64 },
    { 135,  68,  64 }, { 135,  69,  63 }, { 136,  71,  63 }, { 136,  72,  62 },
    { 137,  73,  62 }, { 137,  74,  61 }, { 137,  75,  61 }, { 137,  76,  61 },
    { 138,  77,  60 }, { 138,  78,  60 }, { 138,  80,  59 }, { 138,  81,  59 },
    { 139,  82,  58 }, { 139,  83,  58 }, { 139,  84,  57 }, { 139,  85,  57 },
    { 139,  86,  56 }, { 140,  87,  56 }, { 140,  88,  55 }, { 140,  89,  55 },
    { 140,  90,  54 }, { 140,  91,  54 }, { 140,  92,  53 }, { 140,  93,  53 },
    { 141,  94,  52 }, { 141,  95,  52 }, { 141,  96,  51 }, { 141,  97,  51 },
    { 141,  98,  50 }, { 141,  99,  50 }, { 141, 100,  49 }, { 141, 101,  49 },
    { 141, 102,  49 }, { 141, 103,  48 }, { 141, 104,  48 }, { 141, 105,  47 },
    { 141, 106,  47 }, { 142, 107,  46 }, { 142, 108,  46 }, { 142, 109,  46 },
    { 142, 110,  45 }, { 142, 111,  45 }, { 142, 112,  44 }, { 142, 113,  44 },
    { 142, 114,  44 }, { 142, 115,  43 }, { 142, 116,  43 }, { 142, 117,  42 },
    { 142, 118,  42 }, { 142, 119,  42 }, { 142, 120,  41 }, { 142, 121,  41 },
    { 142, 122,  40 }, { 142, 122,  40 }, { 142, 123,  40 }, { 142, 124,  39 },
    { 142, 125,  39 }, { 142, 126,  39 }, { 142, 127,  38 }, { 142, 128,  38 },
    { 142, 129,  38 }, { 142, 130,  37 }, { 141, 131,  37 }, { 141, 132,  36 },
    { 141, 133,  36 }, { 141, 134,  36 }, { 141, 135,  35 }, { 141, 136,  35 },
    { 141, 137,  35 }, { 141, 137,  34 }, { 141, 138,  34 }, { 141, 139,  34 },
    { 141, 140,  33 }, { 140, 141,  33 }, { 140, 142,  33 }, { 140, 143,  32 },
    { 140, 144,  32 }, { 140, 145,  32 }, { 140, 146,  31 }, { 139, 147,  31 },
    { 139, 148,  31 }, { 139, 149,  31 }, { 139, 150,  31 }, { 138, 151,  30 },
    { 138, 152,  30 }, { 138, 153,  30 }, { 138, 153,  30 }, { 137, 154,  30 },
    { 137, 155,  30 }, { 137, 156,  30 }, { 136, 157,  30 }, { 136, 158,  30 },
    { 136, 159,  30 }, { 135, 160,  30 }, { 135, 161,  31 }, { 134, 162,  31 },
    { 134, 163,  31 }, { 133, 164,  32 }, { 133, 165,  32 }, { 133, 166,  33 },
    { 132, 167,  33 }, { 132, 167,  34 }, { 131, 168,  35 }, { 130, 169,  35 },
    { 130, 170,  36 }, { 129, 171,  37 }, { 129, 172,  38 }, { 128, 173,  39 },
    { 127, 174,  40 }, { 127, 175,  41 }, { 126, 176,  42 }, { 125, 177,  43 },
    { 125, 177,  44 }, { 124, 178,  46 }, { 123, 179,  47 }, { 122, 180,  48 },
    { 122, 181,  50 }, { 121, 182,  51 }, { 120, 183,  53 }, { 119, 184,  54 },
    { 118, 185,  56 }, { 118, 185,  57 }, { 117, 186,  59 }, { 116, 187,  61 },
    { 115, 188,  62 }, { 114, 189,  64 }, { 113, 190,  66 }, { 112, 190,  68 },
    { 111, 191,  69 }, { 110, 192,  71 }, { 109, 193,  73 }, { 108, 194,  75 },
    { 107, 194,  77 }, { 105, 195,  79 }, { 104, 196,  81 }, { 103, 197,  83 },
    { 102, 198,  85 }, { 101, 198,  87 }, { 100, 199,  89 }, {  98, 200,  91 },
    {  97, 201,  94 }, {  96, 201,  96 }, {  95, 202,  98 }, {  93, 203, 100 },
    {  92, 204, 103 }, {  91, 204, 105 }, {  89, 205, 107 }, {  88, 206, 109 },
    {  86, 206, 112 }, {  85, 207, 114 }, {  84, 208, 116 }, {  82, 208, 119 },
    {  81, 209, 121 }, {  79, 210, 124 }, {  78, 210, 126 }, {  76, 211, 129 },
    {  75, 211, 131 }, {  73, 212, 134 }, {  71, 213, 136 }, {  70, 213, 139 },
    {  68, 214, 141 }, {  67, 214, 144 }, {  65, 215, 146 }, {  63, 215, 149 },
    {  62, 216, 151 }, {  60, 216, 154 }, {  58, 217, 157 }, {  56, 217, 159 },
    {  55, 218, 162 }, {  53, 218, 165 }, {  51, 219, 167 }, {  50, 219, 170 },
    {  48, 220, 173 }, {  46, 220, 175 }, {  44, 221, 178 }, {  43, 221, 181 },
    {  41, 221, 183 }, {  39, 222, 186 }, {  38, 222, 189 }, {  36, 223, 191 },
    {  34, 223, 194 }, {  33, 223, 197 }, {  31, 224, 199 }, {  30, 224, 202 },
    {  29, 224, 205 }, {  28, 225, 207 }, {  27, 225, 210 }, {  26, 225, 212 },
    {  25, 226, 215 }, {  24, 226, 218 }, {  24, 226, 220 }, {  24, 227, 223 },
    {  24, 227, 225 }, {  24, 227, 228 }, {  25, 228, 231 }, {  25, 228, 233 },
    {  26, 228, 236 }, {  27, 229, 238 }, {  28, 229, 241 }, {  30, 229, 243 },
    {  31, 230, 246 }, {  33, 230, 248 }, {  34, 230, 250 }, {  36, 231, 253 },
};

inline void pseudoColors(cv::InputArray input, cv::OutputArray output, CMap cmap) {
    const uchar3 *table = nullptr;
    switch (cmap) {
    case CMap::Jet:
        table = cmap_jet;
        break;
    case CMap::CoolWarm:
        table = cmap_coolwarm;
        break;
    case CMap::Inferno:
        table = cmap_inferno;
        break;
    case CMap::Magma:
        table = cmap_magma;
        break;
    case CMap::Plasma:
        table = cmap_plasma;
        break;
    case CMap::Viridis:
        table = cmap_viridis;
        break;
    }

    cv::Mat image = input.getMat();

    Assertion(table != nullptr, "Invalid cmap is specified!");
    Assertion(image.channels() == 1, "Input image must have a single channel!");
    Assertion(image.depth() == CV_8U || image.depth() == CV_32F,
              "Input image must be with 8-bit unsigned integer or 32-bit floating point number!");

    if (image.depth() == CV_32F) {
        image.convertTo(image, CV_8U, 255.0);
    }

    cv::Mat &pseudo = output.getMatRef();
    pseudo = cv::Mat(image.size(), CV_8UC3);
    
    image.forEach<uchar>([&](uchar val, const int p[2]) -> void {
        pseudo.at<cv::Vec3b>(p[0], p[1]) = cv::Vec3b(table[val][0], table[val][1], table[val][2]);
    });
}

}  // namespace lime

#endif  // _CORE_COLORMAP_H_
